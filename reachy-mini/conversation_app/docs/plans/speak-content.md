# Treat Content as Speech

## Goal Description
The goal is to modify the conversation application to treat all text content from the model as speech, sent to the TTS queue. This replaces the previous logic where speech had to be enclosed in double quotes (`"..."`). Actions will continue to be handled via function calls (tools).

## User Review Required
> [!IMPORTANT]
> This change removes the ability to have "thought" or "non-speech" text in the model's output that is NOT spoken. All text content generated by the model will be spoken.
> The `TTSQueue` will also be modified to stop extracting quoted text, meaning it will speak exactly what is passed to it.

## Proposed Changes

### Conversation App

#### [MODIFY] [app.py](file:///home/thor/git/autonomous-intelligence/reachy-mini/conversation_app/app.py)
- Remove `ConversationParser` usage for speech extraction in `process_message`.
- Implement a **sentence accumulator** within the content streaming loop:
    - Accumulate tokens into a buffer.
    - Check for sentence delimiters (`.`, `?`, `!`, `\n`).
    - When a delimiter is found, send the accumulated sentence to `self.speech_handler.speak()`.
- Ensure any remaining text in the buffer is spoken when the stream ends.
- Remove the `ConversationParser` class usage for speech (it might still be used for legacy action parsing if needed, but the requirement says actions are in function calls, so we can likely remove it or ignore it).

#### [MODIFY] [tts_queue.py](file:///home/thor/git/autonomous-intelligence/reachy-mini/conversation_app/tts_queue.py)
- Modify `enqueue_text` to **remove the quote extraction logic**.
- The method should simply take the input `text` and queue it for synthesis, regardless of whether it contains quotes or not.
- Remove `extract_quoted_text` method if it's no longer needed.

## Verification Plan

### Automated Tests
- **New Test Script**: Create `tests/test_speech_content.py` to verify the sentence buffering logic.
    - Mock `SpeechHandler` to capture calls to `speak`.
    - Simulate streaming tokens (including split sentences, multiple sentences, no punctuation).
    - Verify that `speak` is called with correct sentence chunks.

### Manual Verification
- **Run the App**: `python -m conversation_app.app`
- **Interact**: Speak to the robot.
- **Verify**:
    - The robot speaks the response even if it doesn't use quotes.
    - If the robot says `I am "happy"`, it speaks the whole sentence, not just "happy".
    - Long responses are spoken in chunks (sentences) rather than waiting for the full response.
